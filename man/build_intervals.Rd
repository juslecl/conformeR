% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cf_utils.R
\name{build_intervals}
\alias{build_intervals}
\title{Build conformal prediction intervals for difference between observed and counterfactual logcounts}
\usage{
build_intervals(
  test_row,
  qr_model,
  other_scores,
  other_weights,
  w_x,
  alpha,
  gene_idx,
  gene_names,
  tr_flag
)
}
\arguments{
\item{test_row}{A single-row data frame containing covariates (all-but-gene-of-interest logcounts) for the test cell.}

\item{qr_model}{A quantile regression model fitted with conformalCQR.}

\item{other_scores}{Numeric vector of calibration scores.}

\item{other_weights}{Numeric vector of calibration weights.}

\item{w_x}{Numeric scalar, weight associated with the test sample.}

\item{alpha}{Numeric scalar, miscoverage level in (0,1).}

\item{gene_idx}{Column index of the outcome gene.}

\item{gene_names}{Character vector of all gene names.}

\item{tr_flag}{Integer flag (0 or 1) indicating treatment/control setting.}
}
\value{
A numeric vector of length two, giving the lower and upper bounds of the conformal prediction interval.
}
\description{
Internal helper function that constructs prediction intervals for the
difference between observed and counterfactual logcounts using weighted
split-CQR.
}
