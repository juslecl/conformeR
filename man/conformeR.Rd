% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/conformeR.R
\name{conformeR}
\alias{conformeR}
\title{Conformal inference with counterfactual methods for multi-condition single-cell data DE detection}
\usage{
conformeR(
  sce,
  obs_condition,
  replicate_id,
  cell_type,
  spacing = 0.01,
  size_train = 0.5,
  size_cal = 0.25,
  cores = 32,
  cutoff = 0.05
)
}
\arguments{
\item{sce}{A \linkS4class{SingleCellExperiment} object containing
gene expression data ("logcounts" assay).}

\item{obs_condition}{Character scalar. The name of the column in
\code{colData(sce)} indicating the observed condition (e.g., treatment vs control).}

\item{replicate_id}{Character scalar. The name of the column in
\code{colData(sce)} identifying biological replicates (e.g. patient ID).}

\item{cell_type}{Character scalar. The name of the column in
\code{colData(sce)} specifying cell types.}

\item{spacing}{Numeric scalar. Grid spacing for prediction intervals computation.
Default is \code{0.01}.}

\item{size_train}{Numeric scalar between 0 and 1. Proportion of data used
for training. Default is \code{0.5}.}

\item{size_cal}{Numeric scalar between 0 and 1. Proportion of data used
for calibration. Default is \code{0.25}.}

\item{cores}{Integer. Number of parallel workers for computation.
Default is \code{32}.}
}
\value{
A list with the following components:
\describe{
\item{INT}{A tibble of conformal prediction intervals
for each gene x cell x level of confidence.}
\item{FDR}{A tibble summarizing combined FDR per gene and cell_type.}
}
}
\description{
This function computes conformal prediction intervals and FDR-adjusted
results for gene expression data stored in a
\linkS4class{SingleCellExperiment} object. Results are aggregated at \code{cell_type} level.
}
\examples{
\dontrun{
library(SingleCellExperiment)
sce <- mock_sce_object()  # example input
res <- conformeR(sce, obs_condition="treatment",
                 replicate_id="patient_id", cell_type="celltype",
                 cores=4)
}

}
