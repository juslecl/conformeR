% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/conformeR.R
\name{conformeR}
\alias{conformeR}
\title{Conformal inference with counterfactual methods for multi-condition single-cell data DE detection}
\usage{
conformeR(
  sce,
  obs_condition,
  replicate_id,
  cell_type,
  cf_method = c("conformeR", "cfcausal"),
  spacing = 0.01,
  size_train = 0.5,
  size_cal = 0.25,
  cores = 32
)
}
\arguments{
\item{sce}{A \linkS4class{SingleCellExperiment} object containing
gene expression data ("logcounts" assay).}

\item{obs_condition}{Character scalar. The name of the column in
\code{colData(sce)} indicating the observed condition (e.g., treatment vs control).}

\item{replicate_id}{Character scalar. The name of the column in
\code{colData(sce)} identifying biological replicates (e.g. patient ID).}

\item{cell_type}{Character scalar. The name of the column in
\code{colData(sce)} specifying cell types.}

\item{cf_method}{Character scalar, either \code{"conformeR"} (default) or
\code{"cfcausal"}. Determines which counterfactual method is used for interval estimation.}

\item{spacing}{Numeric scalar. Grid spacing for prediction intervals computation.
Default is \code{0.01}.}

\item{size_train}{Numeric scalar between 0 and 1. Proportion of data used
for training. Default is \code{0.5}.}

\item{size_cal}{Numeric scalar between 0 and 1. Proportion of data used
for calibration. Default is \code{0.25}.}

\item{cores}{Integer. Number of parallel workers for computation.
Default is \code{32}.}
}
\value{
A list with the following components:
\describe{
\item{pred_intervals}{A data.frame of conformal prediction intervals
for each gene x cell x level of confidence.}
\item{conformeR_pvalues}{A data.frame containing per-gene x cell p-values.}
\item{gene_fdr_fun}{A list of FDR estimation functions,
one per gene Ã— conformal group.}
\item{comb_fdr}{A tibble summarizing combined FDR per gene.}
}
}
\description{
This function computes conformal prediction intervals and FDR-adjusted
results for gene expression data stored in a
\linkS4class{SingleCellExperiment} object. Results are aggregated at \code{cell_type} level.
Two counterfactual-based methods
are available: \code{"conformeR"} (default) and \code{"cfcausal"}.
}
\examples{
\dontrun{
library(SingleCellExperiment)
sce <- mock_sce_object()  # example input
res <- conformeR(sce, obs_condition="treatment",
                 replicate_id="patient_id", cell_type="celltype",
                 cf_method="conformeR", cores=4)
}

}
