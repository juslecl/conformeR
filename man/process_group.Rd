% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cf_utils.R
\name{process_group}
\alias{process_group}
\title{Process a single group to compute conformal prediction intervals}
\usage{
process_group(
  g,
  dt_train,
  dt_cal,
  dt_test,
  gene_names,
  alphas,
  obs_condition,
  gene_chunk,
  param3
)
}
\arguments{
\item{g}{Character or factor. The identifier of the conformal group to process.}

\item{dt_train}{A \code{data.frame} containing the training set, including covariates,
outcome genes, and the \code{conf_group} column.}

\item{dt_cal}{A \code{data.frame} containing the calibration set.}

\item{dt_test}{A \code{data.frame} containing the test set.}

\item{gene_names}{Character vector of all gene names in the dataset.}

\item{alphas}{Numeric vector of miscoverage levels for which conformal intervals
are computed.}

\item{obs_condition}{Character. Name of the column representing the observed condition
(treatment vs. control).}

\item{gene_chunk}{Integer. Number of genes to process per chunk in order to manage memory usage.}

\item{param3}{A \code{BiocParallelParam} object controlling parallelization for per-gene computations.}
}
\value{
A \code{data.frame} containing conformal prediction intervals for all genes in the
group. Columns include:
\itemize{
\item \code{lower} - Lower bound of the conformal interval
\item \code{upper} - Upper bound of the conformal interval
\item \code{alpha} - Miscoverage level corresponding to the interval
\item \code{gene} - Gene name
\item \code{covered} - Factor indicating whether 0 falls inside the interval ("inside"/"outside")
\item \code{conf_group} - Identifier of the processed group
}
}
\description{
This internal helper function computes conformal prediction intervals for a specific
conformal group. It splits further the data into training,
calibration, and test subsets for the group, fits propensity score and quantile
regression models for each gene, and constructs conformal prediction intervals
across multiple significance levels (alphas).
}
\details{
This function manages the group-level workflow by:
\enumerate{
\item Subsetting the training, calibration, and test sets by conformal group.
\item Preparing combined training/calibration data frames for propensity score modeling.
\item Splitting the list of genes into chunks and delegating computation to
\code{process_gene_chunk()}.
\item Combining per-chunk results into a single data.frame for the group.
}
}
\seealso{
\code{\link{process_gene_chunk}}
}
